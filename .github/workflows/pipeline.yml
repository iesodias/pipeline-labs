name: Demonstração de Variáveis de Ambiente

on:
  push:
    branches:
      - main
  workflow_dispatch:

# Variáveis de ambiente no nível de WORKFLOW

env:
  WORKFLOW_VAR: "Variável definida no nível do workflow"
  AMBIENTE: "producao"
  VERSAO_APP: "1.0.0"

jobs:
  demonstracao-variaveis:
    runs-on: ubuntu-latest

    # Variáveis de ambiente no nível do JOB
    env:
      JOB_VAR: "Variável definida no nível do job"
      USUARIO: "devops-user"

    steps:
      - name: Exibir variáveis do workflow
        run: |
          echo "=== Variáveis do Workflow ==="
          echo "Variável WORKFLOW_VAR: ${{ env.WORKFLOW_VAR }}"
          echo "Ambiente: ${{ env.AMBIENTE }}"
          echo "Versão da aplicação: ${{ env.VERSAO_APP }}"

      - name: Exibir variáveis do job
        run: |
          echo "=== Variáveis do Job ==="
          echo "Variável JOB_VAR: ${{ env.JOB_VAR }}"
          echo "Usuário: ${{ env.USUARIO }}"

      - name: Exibir variável do step
        env:
          STEP_VAR: "Variável definida no nível do step"
          MENSAGEM: "Este é um exemplo prático!"
        run: |
          echo "=== Variáveis do Step ==="
          echo "Variável STEP_VAR: ${{ env.STEP_VAR }}"
          echo "Mensagem: ${{ env.MENSAGEM }}"

      - name: Combinar variáveis de diferentes níveis
        env:
          STEP_ESPECIFICO: "step-value"
        run: |
          echo "=== Combinação de Variáveis ==="
          echo "Workflow: ${{ env.WORKFLOW_VAR }}"
          echo "Job: ${{ env.JOB_VAR }}"
          echo "Step: ${{ env.STEP_ESPECIFICO }}"
          echo "Todas acessíveis no mesmo contexto!"

      - name: Usar variáveis em comandos práticos
        env:
          NOME_PROJETO: "lab-variaveis"
          TIMESTAMP: "2025-01-13"
        run: |
          echo "=== Exemplo Prático ==="
          echo "Compilando projeto: ${{ env.NOME_PROJETO }}"
          echo "Data de build: ${{ env.TIMESTAMP }}"
          echo "Ambiente de deploy: ${{ env.AMBIENTE }}"
          echo "Versão: ${{ env.VERSAO_APP }}"